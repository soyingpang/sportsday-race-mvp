<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>親子遊戲日（本機後台）</title>
  <link rel="stylesheet" href="./assets/app.css" />
</head>
<body>
  <header class="bar">
    <div class="title">親子遊戲日（本機後台 / 不用同步）</div>
    <nav class="nav">
      <a href="./board.html" target="_blank" rel="noopener">看板（下一隊伍 + Top10）</a>
      <button id="btnReset" class="danger">重置本機資料</button>
    </nav>
  </header>
  <div id="diag" class="msg" style="padding:0 16px"></div>

  <main class="grid">
    <section class="card">
      <h2>1) 匯入參賽名單（CSV）</h2>
      <p class="muted">欄位：id,class,no,name,present（present 允許 true/false 或 1/0）</p>
      <div class="row">
        <input type="file" id="fileCsv" accept=".csv,text/csv" />
        <button id="btnLoadSample">載入範例名單</button>
      </div>
      <div id="importMsg" class="msg"></div>
    </section>

    <section class="card">
      <h2>2) 參賽者概覽</h2>
      <div id="participantsSummary" class="mono"></div>
    </section>

    <section class="card span2">
      <h2>3) 賽程建立（4 道 / A2+B2）</h2>
      <p class="muted">用途：只用來「叫下一隊伍」＋「下載賽程表」。不做現場即時入分。</p>

      <div class="row">
        <label>年級
          <select id="selGrade">
            <option value="1">一年級</option>
            <option value="2">二年級</option>
          </select>
        </label>
        <label>項目
          <input id="inpEvent" value="火炬接力跑" />
        </label>
        <label>輪次
          <select id="selRound">
            <option value="預賽">預賽</option>
            <option value="決賽">決賽</option>
          </select>
        </label>
      </div>

      <div class="row">
        <label>A 班
          <select id="selClassA"></select>
        </label>
        <label>B 班
          <select id="selClassB"></select>
        </label>
        <label>場次
          <input id="inpHeatNo" type="number" min="1" value="1" />
        </label>
      </div>

      <div class="row">
        <div class="col">
          <h3>A 班選手（最多 2）</h3>
          <div id="pickA" class="picker"></div>
        </div>
        <div class="col">
          <h3>B 班選手（最多 2）</h3>
          <div id="pickB" class="picker"></div>
        </div>
      </div>

      <div class="row">
        <label>不足 2 人補位策略
          <select id="selFill">
            <option value="other">由另一班補足（先填滿 Lane）</option>
            <option value="empty">保留空道</option>
          </select>
        </label>
        <label>
          <input type="checkbox" id="chkAutoHeats" />
          依勾選名單自動產生多場（每場每班取 2 位，依座號順序）
        </label>
        <button id="btnCreateHeat" class="primary">建立 1 場（取前 2 位）</button>
        <button id="btnAutoHeats" class="primary">一鍵自動排完所有場次</button>
      </div>

      <div class="row">
        <button id="btnExportSchedule" class="primary">下載：賽程表 CSV（按場次排序）</button>
        <span id="exportMsg1" class="muted"></span>
      </div>

      <div id="createMsg" class="msg"></div>
    </section>

    <section class="card span2">
      <h2>4) 組次列表（用來指定看板「目前場次」）</h2>
      <div id="heatsOverview"></div>
      <div id="heatsList"></div>
    </section>

    <section class="card span2">
      <h2>5) 後台入分（3 個遊戲時間累加）</h2>
      <p class="muted">計分員不用輸入。你收齊手寫表後，在這裡輸入三個遊戲的秒數；系統會自動計算總時間並產生 1/2 年級 Top10。</p>

      <div class="row">
        <label>遊戲名稱
          <input id="gLabel1" value="遊戲1" />
        </label>
        <label>
          <input id="gLabel2" value="遊戲2" />
        </label>
        <label>
          <input id="gLabel3" value="遊戲3" />
        </label>
        <button id="btnSaveLabels" class="primary">儲存遊戲名稱</button>
        <span id="labelMsg" class="muted"></span>
      </div>

      <div class="row">
        <label>年級
          <select id="selGradeScore">
            <option value="1">一年級</option>
            <option value="2">二年級</option>
          </select>
        </label>
        <button id="btnExportTotalCsv" class="primary">下載：計分總表 CSV（按場次/年級排序）</button>
        <span id="exportMsg2" class="muted"></span>
      </div>

      <div id="scoreTable"></div>
      <div class="muted">提示：輸入秒數後會自動儲存到本機瀏覽器（localStorage）。</div>
    </section>

  </main>

  <script type="module" src="./assets/app.js"></script>
</body>
</html>
